CREATE OR REPLACE VIEW "집계_프로모션별/상품별/고객평균출생년도" FOLDER = '/99. 관계도' AS SELECT "집계_프로모션별/상품판매DW".p_promo_sk AS p_promo_sk, "집계_프로모션별/상품판매DW".p_promo_name AS p_promo_name, "집계_프로모션별/상품판매DW"."I_ITEM_DESC" AS "I_ITEM_DESC", "집계_프로모션별/상품판매DW".promotion_item_rank AS promotion_item_rank, "집계_프로모션별/상품판매DW".total_sales_price AS total_sales_price, avg("고객상세".c_birth_year) AS agv_birth_year FROM ("집계_프로모션별/상품판매DW" AS "집계_프로모션별/상품판매DW" INNER JOIN "상점_상품판매_DW" AS "상점_상품판매_DW" ON ("집계_프로모션별/상품판매DW".p_promo_sk = "상점_상품판매_DW"."SS_PROMO_SK" AND "집계_프로모션별/상품판매DW"."I_ITEM_ID" = "상점_상품판매_DW"."I_ITEM_ID") ) INNER JOIN "고객상세" AS "고객상세" ON "상점_상품판매_DW"."SS_CUSTOMER_SK" = "고객상세".c_customer_sk  WHERE "집계_프로모션별/상품판매DW".promotion_item_rank <= 4 GROUP BY "집계_프로모션별/상품판매DW".promotion_item_rank, "집계_프로모션별/상품판매DW".total_sales_price, "집계_프로모션별/상품판매DW"."I_ITEM_DESC", "집계_프로모션별/상품판매DW".p_promo_name, "집계_프로모션별/상품판매DW".p_promo_sk ORDER BY p_promo_sk ASC, promotion_item_rank ASC CONTEXT ('I18N' = 'us_pst');

ALTER VIEW "집계_프로모션별/상품별/고객평균출생년도"
 LAYOUT ("집계_프로모션별/상품판매DW" = [20, 20, 200, 200], "상점_상품판매_DW" = [415, 16, 200, 200], "고객상세" = [782, 38, 200, 200]);

