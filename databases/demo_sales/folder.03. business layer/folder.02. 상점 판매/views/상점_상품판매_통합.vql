CREATE OR REPLACE VIEW "상점_상품판매_통합" FOLDER = '/03. business layer/02. 상점 판매' DESCRIPTION = '판매일자와 판매 상품 정보를 포함한 상점 판매 DW 와 History 를 전체 통합'  AS SELECT "SS_SOLD_DATE_SK", "SS_SOLD_TIME_SK", "SS_ITEM_SK", "SS_CUSTOMER_SK", "SS_CDEMO_SK", "SS_HDEMO_SK", "SS_ADDR_SK", "SS_STORE_SK", "SS_PROMO_SK", "SS_TICKET_NUMBER", "SS_QUANTITY", "SS_WHOLESALE_COST", "SS_LIST_PRICE", "SS_SALES_PRICE", "SS_EXT_DISCOUNT_AMOUNT", "SS_EXT_SALES_PRICE", "SS_EXT_WHOLESALE_COST", "SS_EXT_LIST_PRICE", "SS_EXT_TAX", "SS_COUPON_AMT", "SS_NET_PAID", "SS_NET_PAID_INC_TAX", "SS_NET_PROVIT", "I_ITEM_SK", "I_ITEM_ID", "I_REC_START_DATE", "I_REC_END_DATE", "I_ITEM_DESC", "I_CURRENT_PRICE", "I_WHOLESALE_COST", "I_BRAND_ID", "I_BRAND", "I_CLASS_ID", "I_CLASS", "I_CATEGORY_ID", "I_CATEGORY", "I_MANUFACT_ID", "I_MANUFACT", "I_SIZE", "I_FORMULATION", "I_COLOR", "I_UNITS", "I_CONTAINER", "I_MANAGER_ID", "I_PRODUCT_NAME", "D_DATE_SK", "D_DATE_ID", "D_DATE", "D_MONTH_SEQ", "D_WEEK_SEQ", "D_QUARTER_SEQ", "D_YEAR", "D_DOW", "D_MOY", "D_DOM", "D_QOY", "D_FY_YEAR", "D_FY_QUARTER_SEQ", "D_FY_WEEK_SEQ", "D_DAY_NAME", "D_QUARTER_NAME", "D_HOLIDAY", "D_WEEKEND", "D_FOLLOWING_HOLIDAY", "D_FIRST_DOM", "D_LAST_DOM", "D_SAME_DAY_LY", "D_SAME_DAY_LQ", "D_CURRENT_DAY", "D_CURRENT_WEEK", "D_CURRENT_MONTH", "D_CURRENT_QUARTER", "D_CURRENT_YEAR" FROM (SELECT "I_SIZE", "SS_ITEM_SK", "D_WEEKEND", "D_DATE_SK", "D_SAME_DAY_LQ", "D_DAY_NAME", "I_MANUFACT", "I_FORMULATION", "I_UNITS", "D_FIRST_DOM", "D_SAME_DAY_LY", "I_ITEM_DESC", "I_CATEGORY_ID", "D_CURRENT_WEEK", "D_QUARTER_NAME", "D_HOLIDAY", "I_BRAND_ID", "SS_PROMO_SK", "D_DATE", "D_DATE_ID", "D_QOY", "D_LAST_DOM", "SS_SOLD_DATE_SK", "D_CURRENT_QUARTER", "D_MOY", "SS_EXT_LIST_PRICE", "I_COLOR", "SS_COUPON_AMT", "SS_SOLD_TIME_SK", "D_CURRENT_MONTH", "SS_CUSTOMER_SK", "D_DOW", "SS_SALES_PRICE", "SS_EXT_WHOLESALE_COST", "D_FY_QUARTER_SEQ", "I_REC_START_DATE", "D_WEEK_SEQ", "SS_ADDR_SK", "D_FOLLOWING_HOLIDAY", "I_ITEM_SK", "SS_HDEMO_SK", "SS_NET_PAID_INC_TAX", "I_CURRENT_PRICE", "SS_EXT_SALES_PRICE", "SS_LIST_PRICE", "I_CATEGORY", "D_FY_YEAR", "SS_EXT_TAX", "D_YEAR", "SS_QUANTITY", "SS_NET_PROVIT", "SS_EXT_DISCOUNT_AMOUNT", "I_CLASS_ID", "D_FY_WEEK_SEQ", "I_PRODUCT_NAME", "D_CURRENT_DAY", "D_MONTH_SEQ", "D_DOM", "SS_TICKET_NUMBER", "I_ITEM_ID", "D_QUARTER_SEQ", "SS_NET_PAID", "I_MANAGER_ID", "I_CLASS", "D_CURRENT_YEAR", "I_MANUFACT_ID", "SS_CDEMO_SK", "SS_WHOLESALE_COST", "SS_STORE_SK", "I_REC_END_DATE", "I_CONTAINER", "I_WHOLESALE_COST", "I_BRAND" AS "I_BRAND" FROM "상점_상품판매_DW" EXTENDED UNION ALL SELECT "D_CURRENT_QUARTER", "D_DOW", "I_MANAGER_ID", "SS_COUPON_AMT", "D_LAST_DOM", "SS_WHOLESALE_COST", "SS_NET_PAID", "SS_SALES_PRICE", "D_FY_QUARTER_SEQ", "I_REC_END_DATE", "D_QUARTER_SEQ", "SS_STORE_SK", "I_ITEM_ID", "D_FY_YEAR", "D_CURRENT_YEAR", "I_MANUFACT_ID", "SS_EXT_TAX", "SS_ADDR_SK", "I_SIZE", "SS_ITEM_SK", "SS_NET_PROVIT", "D_QUARTER_NAME", "SS_CDEMO_SK", "SS_PROMO_SK", "I_CLASS", "D_CURRENT_DAY", "I_REC_START_DATE", "SS_LIST_PRICE", "I_CATEGORY_ID", "D_WEEKEND", "I_BRAND_ID", "SS_TICKET_NUMBER", "I_CATEGORY", "D_DATE_SK", "I_CURRENT_PRICE", "D_WEEK_SEQ", "D_CURRENT_WEEK", "SS_EXT_LIST_PRICE", "I_BRAND" AS "I_BRAND", "D_DOM", "D_MONTH_SEQ", "D_HOLIDAY", "I_CONTAINER", "I_COLOR", "I_WHOLESALE_COST", "I_MANUFACT", "D_DATE_ID", "SS_EXT_WHOLESALE_COST", "SS_CUSTOMER_SK", "D_DAY_NAME", "SS_EXT_SALES_PRICE", "SS_HDEMO_SK", "D_SAME_DAY_LQ", "I_PRODUCT_NAME", "I_FORMULATION", "I_UNITS", "D_FIRST_DOM", "D_CURRENT_MONTH", "D_SAME_DAY_LY", "SS_NET_PAID_INC_TAX", "SS_SOLD_TIME_SK", "D_MOY", "SS_QUANTITY", "D_YEAR", "I_CLASS_ID", "D_FY_WEEK_SEQ", "D_DATE", "SS_EXT_DISCOUNT_AMOUNT", "I_ITEM_SK", "D_QOY", "I_ITEM_DESC", "D_FOLLOWING_HOLIDAY", "SS_SOLD_DATE_SK" FROM "상점_상품판매_HISTORY") CONTEXT ('I18N' = 'us_pst');

ALTER VIEW "상점_상품판매_통합"
 LAYOUT ("상점_상품판매_DW" = [20, 20, 200, 200], "상점_상품판매_HISTORY" = [323, 11, 200, 200]);

